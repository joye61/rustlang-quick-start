好的，我们来系统、简洁、全面地讲解 **Rust 的数组（array）**，覆盖语法、特性、操作和示例。

---

## 1️⃣ 什么是数组

- 数组是 **固定长度、同类型元素的集合**。
- 在内存中连续存储。
- 与向量 `Vec` 不同：数组 **长度固定、不可动态增长**。

```rust
let a: [i32; 5]; // 类型 i32，长度 5
```

- `[i32; 5]` 表示 **类型 i32，长度为 5**。
- Rust 的数组长度是类型的一部分。

---

## 2️⃣ 数组初始化

### 2.1 显式初始化

```rust
let arr: [i32; 5] = [1, 2, 3, 4, 5];
```

- 数组长度必须与元素个数匹配。

### 2.2 重复元素初始化

```rust
let arr = [0; 10]; // [0,0,0,0,0,0,0,0,0,0]
```

- `[value; N]`：生成 N 个 value 的数组。

---

## 3️⃣ 访问数组元素

```rust
let arr = [10, 20, 30];
println!("First: {}", arr[0]);
println!("Second: {}", arr[1]);
```

- 使用索引访问，索引从 0 开始。
- **超出索引会 panic**，Rust 会在运行时检查。

---

## 4️⃣ 数组长度与切片

```rust
let arr = [1, 2, 3, 4, 5];
println!("Length: {}", arr.len());

let slice = &arr[1..4]; // 切片: [2,3,4]
println!("{:?}", slice);
```

- `arr.len()` 获取长度。
- 切片 `&arr[start..end]` 提取数组子序列。
- 切片是引用，不会拷贝数据。

---

## 5️⃣ 遍历数组

### 5.1 for 循环

```rust
let arr = [10, 20, 30];

for i in 0..arr.len() {
    println!("{}", arr[i]);
}
```

### 5.2 for-in 循环

```rust
for val in arr.iter() {
    println!("{}", val);
}
```

- `.iter()` 返回不可变迭代器。
- `.iter_mut()` 返回可变迭代器，可修改数组元素。

```rust
let mut arr = [1, 2, 3];
for val in arr.iter_mut() {
    *val += 1;
}
println!("{:?}", arr); // [2,3,4]
```

---

## 6️⃣ 多维数组

```rust
let matrix: [[i32; 3]; 2] = [
    [1, 2, 3],
    [4, 5, 6],
];
println!("{}", matrix[1][2]); // 6
```

- `[T; N]` 嵌套表示多维数组。
- 类型 `[i32;3];2` 表示 2 行 3 列。

---

## 7️⃣ 数组与模式匹配

```rust
let arr = [1, 2, 3];

match arr {
    [1, x, 3] => println!("Middle is {}", x),
    _ => println!("Other pattern"),
}
```

- Rust 支持数组模式匹配。
- 可以匹配固定长度和特定元素。

---

## 8️⃣ 注意事项

1. **长度固定**：数组在编译时确定长度。
2. **类型统一**：所有元素必须是同一类型。
3. **不可变/可变**：

   - 默认数组不可变。
   - 用 `mut` 声明可变数组。

4. **索引越界**会 panic。

---

## 9️⃣ 总结

| 特性         | 描述                                            |
| ------------ | ----------------------------------------------- |
| 固定长度     | `[T; N]`，长度在编译期确定                      |
| 元素类型统一 | 所有元素必须同类型                              |
| 索引访问     | `arr[i]`，超出索引 panic                        |
| 遍历         | `.iter()`, `.iter_mut()` 或 `for i in 0..len()` |
| 多维数组     | `[[T; M]; N]`，支持矩阵等结构                   |
| 切片         | `&arr[start..end]`，安全引用数组子集            |
| 模式匹配     | 支持 `[a,b,c]` 等固定模式匹配                   |

---

数组在 Rust 中是基础且高性能的集合类型。掌握数组能为理解 **切片、向量 Vec、迭代器** 打下基础。

---

我可以画一张 **Rust 数组结构示意图**，展示固定长度、多维数组和切片的关系，让概念更直观。

你希望我画吗？
