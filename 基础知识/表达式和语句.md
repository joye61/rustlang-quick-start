## 基本概念

### 表达式（Expression）

* 表达式是会 **计算出一个值** 的代码。
* 可以出现在语句中或赋值给变量。
* **表达式不会以分号 `;` 结束**（如果加了分号，它就变成语句）。

**常见表达式类型：**

1. 字面量：`5`, `"hello"`, `true`
2. 运算：`1 + 2`, `x * y`
3. 函数调用：`foo()`
4. 块表达式：`{ let x = 1; x + 2 }`（整个块是表达式，值为 `3`）
5. 条件表达式：`if a > b { a } else { b }`
6. 循环表达式：`loop { break 5; }`（循环可以返回值）

**示例：**

```rust
let x = 5;           // '5' 是表达式
let y = {
    let a = 3;
    a + 2             // 块的最后一行是表达式，返回值 5
};
let max = if x > y { x } else { y }; // 条件表达式
let z = loop {
    break x + y;      // loop 表达式，返回值赋给 z
};
```

### 语句（Statement）

语句是 **执行动作但不返回值** 的代码，通常以分号 `;` 结束。语句分两类：

1. **声明语句**：定义变量或函数

    ```rust
    let x = 5;    // 声明语句
    ```
2. **表达式语句**：把表达式变成语句（加分号，丢掉返回值）

    ```rust
    x + 1;        // 表达式语句，结果被丢弃
    ```


## 表达式 vs 语句的区别

| 特性      | 表达式       | 语句                 |
| ------- | --------- | ------------------ |
| 是否返回值   | 返回值       | 不返回值（返回 `()` 单元类型） |
| 是否可以加分号 | 可以，但会变成语句 | 必须以分号结束            |
| 用途      | 计算和赋值     | 执行动作、声明            |

**示例区别：**

```rust
let x = 5;            // 语句
let y = 6;            // 语句
let z = x + y;         // 赋值表达式，右边是表达式
x + y;                 // 纯表达式语句，返回值被丢弃
```

如果给表达式加分号：

```rust
let z = {
    let a = 1;
    let b = 2;
    a + b              // 没加分号，返回 3
};
let w = {
    let a = 1;
    let b = 2;
    a + b;             // 加了分号，整个块返回 ()
};
```

## 块表达式（Block Expression）

* 用 `{}` 包裹一组语句和表达式。
* 整个块是一个表达式，其值为块中 **最后一个表达式的值**（若最后有分号，则返回 `()`）。

**示例：**

```rust
let x = {
    let a = 10;
    let b = 20;
    a + b   // 最后一行没分号，块的值是 30
};
```


## 控制流表达式

在 Rust 中，控制流也是表达式，可以返回值：

### if 表达式

```rust
let x = 10;
let y = if x > 5 { "big" } else { "small" };
```

### loop 表达式

在 `loop` 语句中，也可以通过 `break` 返回值：

```rust
let mut counter = 0;
let result = loop {
    counter += 1;
    if counter == 10 {
        break counter * 2;  // break 返回值
    }
};
```

### while 和 for

`while` 和 `for` **不能直接返回值**，通常只做动作：

```rust
let mut n = 0;
while n < 5 {
    n += 1;
}

for i in 0..5 {
    println!("{}", i);
}
```


## 函数调用与宏

**函数调用**是表达式：

```rust
fn add(a: i32, b: i32) -> i32 { a + b }
let sum = add(2, 3);  // 5
```

**宏调用**也通常是表达式：

```rust
let s = format!("{} + {} = {}", 2, 3, 2+3); 
```


## 单元类型 `()`

Rust 中没有返回值的语句或函数返回 `()`，可以理解为“空值”

```rust
let x = ();
let y = {
    let a = 1;
    let b = 2;
    a + b;   // 分号 => 返回 ()
};
```


## **7. 小结与记忆技巧**

1. **语句** 不返回值，用分号。
2. **表达式** 可以返回值，最后一行没分号。
3. **块 `{}` 是表达式**，值为最后一个表达式。
4. **控制流在 Rust 中是表达式**（if、loop），除了 for/while。
5. **分号是关键**：加分号就丢掉值，变成语句。
