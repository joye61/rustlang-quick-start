## 什么是枚举

枚举（`enum`）是一种 **自定义类型**，它可以表示 **一组可能的值**，每个值叫 **变体（variant）**。
枚举非常适合 **有限状态、类型选择或多种可能类型的组合**。

```rust
enum Direction {
    Up,
    Down,
    Left,
    Right,
}
```

* `Direction` 是枚举类型名。
* `Up`, `Down` 等是枚举的 **变体**。
* 枚举可以理解为比布尔值、整数更丰富的“标签类型”。


## 创建枚举实例

```rust
fn main() {
    let go = Direction::Up;
    
    match go {
        Direction::Up => println!("Going up!"),
        Direction::Down => println!("Going down!"),
        Direction::Left => println!("Going left!"),
        Direction::Right => println!("Going right!"),
    }
}
```

* 用 `::` 访问变体。
* 枚举和模式匹配结合使用非常强大。


## 带数据的枚举

枚举变体可以携带 **额外的数据**：

```rust
enum Message {
    Quit,                    // 无数据
    Move { x: i32, y: i32 }, // 结构体风格
    Write(String),           // 元组风格
    ChangeColor(i32, i32, i32),
}

fn main() {
    let msg1 = Message::Write(String::from("Hello"));
    let msg2 = Message::Move { x: 10, y: 20 };

    match msg1 {
        Message::Quit => println!("Quit"),
        Message::Move { x, y } => println!("Move to {},{}", x, y),
        Message::Write(s) => println!("Write {}", s),
        Message::ChangeColor(r,g,b) => println!("Color {} {} {}", r,g,b),
    }
}
```

* **元组风格**：`Write(String)`
* **结构体风格**：`Move { x, y }`
* 可以根据不同变体携带不同类型和数量的数据。


## 枚举与方法（impl 块）

枚举可以实现方法：

```rust
enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

impl Coin {
    fn value_in_cents(&self) -> u8 {
        match self {
            Coin::Penny => 1,
            Coin::Nickel => 5,
            Coin::Dime => 10,
            Coin::Quarter => 25,
        }
    }
}

fn main() {
    let coin = Coin::Dime;
    println!("Value: {} cents", coin.value_in_cents());
}
```

* `&self` 表示不可变借用。
* 可以在方法中匹配自身的变体。


## 枚举与 Option/Result

Rust 核心库广泛使用枚举：

### Option

```rust
let some_number = Some(5);
let no_number: Option<i32> = None;

if let Some(n) = some_number {
    println!("Number is {}", n);
}
```

### Result

```rust
fn divide(a: f64, b: f64) -> Result<f64, String> {
    if b == 0.0 {
        Err(String::from("Divide by zero"))
    } else {
        Ok(a / b)
    }
}

match divide(10.0, 2.0) {
    Ok(v) => println!("Result: {}", v),
    Err(e) => println!("Error: {}", e),
}
```

* `Option<T>`：表示可能有值或没有值
* `Result<T, E>`：表示成功或错误
* 它们本质都是枚举。


## 枚举和模式匹配高级用法

### 匹配多个变体

```rust
enum Shape {
    Circle(f64),
    Rectangle(f64, f64),
    Square(f64),
}

fn area(shape: Shape) -> f64 {
    match shape {
        Shape::Circle(r) => 3.14 * r * r,
        Shape::Rectangle(w,h) | Shape::Square(w) => w * h.unwrap_or(w),
    }
}
```

> 注意：`|` 可以匹配多个变体，但数据解构需要一致。

### 使用 `_` 忽略其他情况

```rust
match coin {
    Coin::Penny => println!("1 cent"),
    _ => (), // 其他情况不处理
}
```


## 枚举总结

| 特性              | 描述                    |
| --------------- | --------------------- |
| 简单枚举            | 仅变体，无数据               |
| 元组/结构体风格枚举      | 变体携带数据                |
| 方法与 impl        | 枚举可以实现方法              |
| 与模式匹配结合         | 强大，几乎所有分支逻辑用 match 处理 |
| Option / Result | Rust 核心库大量使用枚举        |
